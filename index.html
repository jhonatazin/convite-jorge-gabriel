<script>
  // ... (código anterior permanece igual)

  form.addEventListener('submit', async (e) => {
    e.preventDefault();
    const name = nameInput.value.trim();
    if (!name) return alert("Por favor, digite seu nome.");

    // Desabilitar botão durante o processamento
    const submitButton = form.querySelector('button[type="submit"]');
    const originalText = submitButton.innerHTML;
    submitButton.innerHTML = "Enviando...";
    submitButton.disabled = true;

    try {
      await fetch('https://script.google.com/macros/s/AKfycbyxwS4guOrPGZi2S7J5dcS6zdnVgBESiqklU-u3lkySgftDlzkM7jaYpTtoMuPc6BEe/exec', {
        method: 'POST',
        mode: 'no-cors',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ name })
      });
      
      // Sempre ocultar o formulário após tentativa de envio
      form.classList.add('hidden');
      thanksBox.classList.remove('hidden');
      
    } catch (error) {
      console.error("Erro ao enviar:", error);
      alert("Ocorreu um erro, mas sua presença foi registrada localmente!");
      
      // Mesmo com erro, ocultar o formulário
      form.classList.add('hidden');
      thanksBox.classList.remove('hidden');
    } finally {
      // Reativar botão (só seria necessário se não ocultássemos o form)
      submitButton.disabled = false;
      submitButton.innerHTML = originalText;
    }
  });
</script>